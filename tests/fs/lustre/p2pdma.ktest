#!/usr/bin/env bash
# SPDX-License-Identifier: GPL-2.0

#
# Copyright (c) 2024, Amazon and/or its affiliates. All rights reserved.
# Use is subject to license terms.
#

#
# Just boot using the Lustre kernel config
#
# Author: Timothy Day <timday@amazon.com>
#

. "$(dirname "$(readlink -e "${BASH_SOURCE[0]}")")/lustre-libs.sh"

require-lustre-kernel-config
require-lustre-debug-kernel-config

require-kernel-config XEN
require-kernel-config XEN_PVHVM
require-kernel-config XEN_PVHVM_SMP
require-kernel-config XEN_PVHVM_GUEST
require-kernel-config XEN_SAVE_RESTORE
require-kernel-config XEN_PVH
require-kernel-config PCI_XEN
require-kernel-config XEN_BLKDEV_FRONTEND
require-kernel-config XEN_NETDEV_FRONTEND
require-kernel-config HVC_XEN
require-kernel-config HVC_XEN_FRONTEND
require-kernel-config XEN_BACKEND
require-kernel-config XEN_COMPAT_XENFS
require-kernel-config XEN_SYS_HYPERVISOR
require-kernel-config XEN_XENBUS_FRONTEND
require-kernel-config XEN_PCI_STUB
require-kernel-config XEN_AUTO_XLATE
require-kernel-config XEN_ACPI

require-kernel-config EFI
require-kernel-config XEN_EFI

require-kernel-config MEMORY_HOTPLUG
require-kernel-config MEMORY_HOTREMOVE
require-kernel-config SPARSEMEM_VMEMMAP
require-kernel-config ZONE_DEVICE
require-kernel-config PCI_P2PDMA

config-mem 10G
config-timeout 60

test_boot()
{
    echo boot
}

main "$@"
